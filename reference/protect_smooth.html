<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Protect a sdc_raster by smoothing — protect_smooth • sdcSpatial</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Protect a sdc_raster by smoothing — protect_smooth" />
<meta property="og:description" content="protect_smooth reduces the sensitivity by applying a Gaussian smoother,
making the values less localized." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sdcSpatial</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.5.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/privacy_protecting_maps.html">Introducing sdcSpatial</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/edwindj/sdcSpatial/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Protect a sdc_raster by smoothing</h1>
    <small class="dont-index">Source: <a href='https://github.com/edwindj/sdcSpatial/blob/master/R/protect_smooth.R'><code>R/protect_smooth.R</code></a></small>
    <div class="hidden name"><code>protect_smooth.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>protect_smooth</code> reduces the sensitivity by applying a Gaussian smoother,
making the values less localized.</p>
    </div>

    <pre class="usage"><span class='fu'>protect_smooth</span><span class='op'>(</span><span class='va'>x</span>, bw <span class='op'>=</span> <span class='fu'>raster</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/raster/man/resolution.html'>res</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>$</span><span class='va'>value</span><span class='op'>)</span>, <span class='va'>...</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>raster object</p></td>
    </tr>
    <tr>
      <th>bw</th>
      <td><p>bandwidth</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>passed through to <code><a href='https://rdrr.io/pkg/raster/man/focal.html'>focal</a></code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The sensitivity of a raster can be decreased by applying a kernel density smoother as
argued by de Jonge et al. (2016) and de Wolf et al. (2018). Smoothing spatially spreads
localized values, reducing the risk for location disclosure. Note that
smoothing often visually enhances detection of spatial patterns.
The kernel applied is a Gaussian kernel with a bandwidth <code>bw</code> supplied by the user.
The smoother acts upon the <code>x$value$count</code> and <code>x$value$sum</code>
from which a new <code>x$value$mean</code> is derived.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>de Jonge, E., &amp; de Wolf, P. P. (2016, September).
Spatial smoothing and statistical disclosure control.
In International Conference on Privacy in Statistical Databases
(pp. 107-117). Springer, Cham.</p>
<p>de Wolf, P. P., &amp; de Jonge, E. (2018, September).
Safely Plotting Continuous Variables on a Map. In International Conference
on Privacy in Statistical Databases (pp. 347-359). Springer, Cham.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>Other protection methods: 
<code><a href='protect_quadtree.html'>protect_quadtree</a>()</code>,
<code><a href='remove_sensitive.html'>remove_sensitive</a>()</code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/edwindj/sdcSpatial'>sdcSpatial</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://rspatial.org/raster'>raster</a></span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>enterprises</span><span class='op'>)</span>

<span class='co'># create a sdc_raster from point data with raster with</span>
<span class='co'># a resolution of 200m</span>
<span class='va'>production</span> <span class='op'>&lt;-</span> <span class='fu'><a href='sdc_raster.html'>sdc_raster</a></span><span class='op'>(</span><span class='va'>enterprises</span>, variable <span class='op'>=</span> <span class='st'>"production"</span>
                        , r <span class='op'>=</span> <span class='fl'>200</span>, min_count <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>production</span><span class='op'>)</span>
</div><div class='output co'>#&gt; numeric sdc_raster object: 
#&gt;    resolution: 200 200 ,  max_risk: 0.95 , min_count: 3 
#&gt;    mean sensitivity score [0,1]:  0.6328234</div><div class='input'>
<span class='co'># plot the raster</span>
<span class='va'>zlim</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>3e4</span><span class='op'>)</span>
<span class='co'># show which raster cells are sensitive</span>
<span class='fu'><a href='https://rdrr.io/pkg/raster/man/plot.html'>plot</a></span><span class='op'>(</span><span class='va'>production</span>, zlim<span class='op'>=</span><span class='va'>zlim</span><span class='op'>)</span>
</div><div class='img'><img src='protect_smooth-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># but we can also retrieve directly the raster</span>
<span class='va'>sensitive</span> <span class='op'>&lt;-</span> <span class='fu'><a href='is_sensitive.html'>is_sensitive</a></span><span class='op'>(</span><span class='va'>production</span>, min_count <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/pkg/raster/man/plot.html'>plot</a></span><span class='op'>(</span><span class='va'>sensitive</span>, col <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'white'</span>, <span class='st'>'red'</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='img'><img src='protect_smooth-2.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># what is the sensitivy fraction?</span>
<span class='fu'><a href='sensitivity_score.html'>sensitivity_score</a></span><span class='op'>(</span><span class='va'>production</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] 0.6328234</div><div class='input'><span class='co'># or equally</span>
<span class='fu'><a href='https://rdrr.io/pkg/raster/man/cellStats.html'>cellStats</a></span><span class='op'>(</span><span class='va'>sensitive</span>, <span class='va'>mean</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] 0.6328234</div><div class='input'>
<span class='co'># let's smooth to reduce the sensitivity</span>
<span class='va'>smoothed</span> <span class='op'>&lt;-</span> <span class='fu'>protect_smooth</span><span class='op'>(</span><span class='va'>production</span>, bw <span class='op'>=</span> <span class='fl'>400</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/pkg/raster/man/plot.html'>plot</a></span><span class='op'>(</span><span class='va'>smoothed</span><span class='op'>)</span>
</div><div class='img'><img src='protect_smooth-3.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># let's smooth to reduce the sensitivity, with higher resolution</span>
<span class='va'>smoothed</span> <span class='op'>&lt;-</span> <span class='fu'>protect_smooth</span><span class='op'>(</span><span class='va'>production</span>, bw <span class='op'>=</span> <span class='fl'>400</span>, fact<span class='op'>=</span><span class='fl'>4</span>, keep_resolution<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/pkg/raster/man/plot.html'>plot</a></span><span class='op'>(</span><span class='va'>smoothed</span><span class='op'>)</span>
</div><div class='img'><img src='protect_smooth-4.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># what is the sensitivy fraction?</span>
<span class='fu'><a href='sensitivity_score.html'>sensitivity_score</a></span><span class='op'>(</span><span class='va'>smoothed</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] 0.007962441</div><div class='input'>
<span class='co'># let's remove the sensitive data.</span>
<span class='va'>smoothed_safe</span> <span class='op'>&lt;-</span> <span class='fu'><a href='remove_sensitive.html'>remove_sensitive</a></span><span class='op'>(</span><span class='va'>smoothed</span>, min_count <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/pkg/raster/man/plot.html'>plot</a></span><span class='op'>(</span><span class='va'>smoothed_safe</span><span class='op'>)</span>
</div><div class='img'><img src='protect_smooth-5.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># let's communicate!</span>
<span class='va'>production_mean</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>smoothed_safe</span><span class='op'>)</span>
<span class='va'>production_total</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>smoothed_safe</span><span class='op'>)</span>

<span class='co'># and create a contour plot</span>
<span class='fu'>raster</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/raster/man/filledContour.html'>filledContour</a></span><span class='op'>(</span><span class='va'>production_mean</span>, nlevels <span class='op'>=</span> <span class='fl'>6</span>, main <span class='op'>=</span> <span class='st'>"Mean production"</span><span class='op'>)</span>
</div><div class='img'><img src='protect_smooth-6.png' alt='' width='700' height='433' /></div><div class='input'>

<span class='co'># generated with R 3.6 &gt;=</span>
<span class='co'>#col &lt;- hcl.colors(11, rev=TRUE)</span>
<span class='va'>col</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"#FDE333"</span>, <span class='st'>"#C2DE34"</span>, <span class='st'>"#7ED357"</span>, <span class='st'>"#00C475"</span>, <span class='st'>"#00B28A"</span>, <span class='st'>"#009B95"</span>
        ,  <span class='st'>"#008298"</span>, <span class='st'>"#006791"</span>, <span class='st'>"#274983"</span>, <span class='st'>"#44286E"</span>, <span class='st'>"#4B0055"</span>
        <span class='op'>)</span>
<span class='fu'>raster</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/raster/man/filledContour.html'>filledContour</a></span><span class='op'>(</span><span class='va'>production_total</span>, nlevels <span class='op'>=</span> <span class='fl'>11</span>
             , col <span class='op'>=</span> <span class='va'>col</span>
             , main<span class='op'>=</span><span class='st'>"Total production"</span><span class='op'>)</span>
</div><div class='img'><img src='protect_smooth-7.png' alt='' width='700' height='433' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Edwin de Jonge, Peter-Paul de Wolf.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


